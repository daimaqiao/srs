<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">

  <script src="https://cdn.bootcss.com/hls.js/0.12.4/hls.min.js"></script>
  <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
  <script src="counter.js"></script>

  <title>Livestream test(v3)</title>

  <style>
  .mainContainer {
        display: block;
        width: 1024px;
        margin-left: auto;
        margin-right: auto;
  }

  .centeredVideo {
        display: block;
        width: 100%;
        height: 576px;
        margin-left: auto;
        margin-right: auto;
        margin-bottom: auto;
  }
  </style>

</head>

<body>
  <p>
  <div id="mainContainer" class="mainContainer">
  <video id='video' class="centeredVideo" controls poster='/poster/live.jpg' onplay="countPlayer()">
  </video>
  </div>
  </p>

  <p>
  <a href="livestream_lower.html">切换到低码率（画质较差）</a>
  </p>

  <p>
  <span id="out"></span>
  </p>

  <script>
    var video = document.getElementById('video');
    if (video.canPlayType('application/vnd.apple.mpegurl')) {
      console.log("play type: application/vnd.apple.mpegurl.");
      video.src = '/live/livestream.m3u8';
    }
    else if(Hls.isSupported()) {
      console.log("hls(js) is supported.");
      var hls = new Hls();
      hls.loadSource('/live/livestream.m3u8');
      hls.attachMedia(video);
    }
    else {
	// FIXME
    }
  </script>

</body>
</html>
